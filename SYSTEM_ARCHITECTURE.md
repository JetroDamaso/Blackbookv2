# ğŸ“Š System Architecture Diagram

## ğŸ—ï¸ Complete System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          USER INTERFACE                              â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Sidebar   â”‚  â”‚   Dashboard  â”‚  â”‚   Booking Creation Form    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”‚  â”‚              â”‚  â”‚                            â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ””(3)â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  [Event Name]              â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚Pending â”‚  â”‚  â”‚  [Client]                  â”‚  â”‚
â”‚  â”‚  Bell Icon â”‚  â”‚  â”‚  25    â”‚  â”‚  â”‚  [Date/Time]               â”‚  â”‚
â”‚  â”‚            â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  ...                       â”‚  â”‚
â”‚  â”‚            â”‚  â”‚              â”‚  â”‚  [Create Booking] â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REACT COMPONENTS & HOOKS                          â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚             BookingSystemProvider (Root Layout)                 â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚  â”‚ useBookingStatusUpdater â”‚  â”‚    useNotifications          â”‚â”‚ â”‚
â”‚  â”‚  â”‚                         â”‚  â”‚                              â”‚â”‚ â”‚
â”‚  â”‚  â”‚  setInterval(5000ms)    â”‚  â”‚   setInterval(10000ms)       â”‚â”‚ â”‚
â”‚  â”‚  â”‚         â†“               â”‚  â”‚          â†“                   â”‚â”‚ â”‚
â”‚  â”‚  â”‚  Check all bookings     â”‚  â”‚   Check payment dates        â”‚â”‚ â”‚
â”‚  â”‚  â”‚  Update statuses        â”‚  â”‚   Check unpaid status        â”‚â”‚ â”‚
â”‚  â”‚  â”‚  Log changes            â”‚  â”‚   Create notifications       â”‚â”‚ â”‚
â”‚  â”‚  â”‚  Trigger re-renders     â”‚  â”‚   Show toast popups          â”‚â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â”‚                     â†“                        â†“                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                        â–¼                        â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Component Re-renders & Toast Notifications         â”‚ â”‚
â”‚  â”‚   â€¢ BookingStatusBadge updates colors                           â”‚ â”‚
â”‚  â”‚   â€¢ NotificationBell updates badge count                        â”‚ â”‚
â”‚  â”‚   â€¢ BookingStatusDashboard updates statistics                   â”‚ â”‚
â”‚  â”‚   â€¢ Toast popups appear for new notifications                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BUSINESS LOGIC LAYER                         â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  status-updater.ts â”‚  â”‚ notification-       â”‚  â”‚ integration. â”‚ â”‚
â”‚  â”‚                    â”‚  â”‚ checker.ts          â”‚  â”‚ ts           â”‚ â”‚
â”‚  â”‚  calculateBooking  â”‚  â”‚                     â”‚  â”‚              â”‚ â”‚
â”‚  â”‚  Status()          â”‚  â”‚  checkPayment       â”‚  â”‚ integrateNew â”‚ â”‚
â”‚  â”‚  â€¢ Check dates     â”‚  â”‚  Alerts()           â”‚  â”‚ Booking()    â”‚ â”‚
â”‚  â”‚  â€¢ Check payment   â”‚  â”‚  â€¢ 1 week before    â”‚  â”‚              â”‚ â”‚
â”‚  â”‚  â€¢ Return status   â”‚  â”‚  â€¢ 3 days before    â”‚  â”‚ syncAll      â”‚ â”‚
â”‚  â”‚                    â”‚  â”‚  â€¢ 1 day before     â”‚  â”‚ Bookings()   â”‚ â”‚
â”‚  â”‚  updateAllBooking  â”‚  â”‚                     â”‚  â”‚              â”‚ â”‚
â”‚  â”‚  Statuses()        â”‚  â”‚  checkUnpaid        â”‚  â”‚ updateBookingâ”‚ â”‚
â”‚  â”‚  â€¢ Loop bookings   â”‚  â”‚  Reminders()        â”‚  â”‚ Payment()    â”‚ â”‚
â”‚  â”‚  â€¢ Calculate each  â”‚  â”‚  â€¢ Every 3 days     â”‚  â”‚              â”‚ â”‚
â”‚  â”‚  â€¢ Update changed  â”‚  â”‚                     â”‚  â”‚              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â†•                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATA PERSISTENCE LAYER                       â”‚
â”‚                             (storage.ts)                              â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   Browser LocalStorage                          â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  Key: "bookings"                                                â”‚ â”‚
â”‚  â”‚  Value: [                                                       â”‚ â”‚
â”‚  â”‚    {                                                            â”‚ â”‚
â”‚  â”‚      id: 123,                                                   â”‚ â”‚
â”‚  â”‚      eventName: "Birthday Party",                              â”‚ â”‚
â”‚  â”‚      startAt: "2024-12-25T10:00:00Z",                         â”‚ â”‚
â”‚  â”‚      endAt: "2024-12-25T15:00:00Z",                           â”‚ â”‚
â”‚  â”‚      status: 2,  // Confirmed                                  â”‚ â”‚
â”‚  â”‚      balance: 5000,                                            â”‚ â”‚
â”‚  â”‚      originalPrice: 10000,                                     â”‚ â”‚
â”‚  â”‚      ...                                                        â”‚ â”‚
â”‚  â”‚    },                                                           â”‚ â”‚
â”‚  â”‚    ...                                                          â”‚ â”‚
â”‚  â”‚  ]                                                              â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  Key: "notifications"                                           â”‚ â”‚
â”‚  â”‚  Value: [                                                       â”‚ â”‚
â”‚  â”‚    {                                                            â”‚ â”‚
â”‚  â”‚      id: "notif_abc123",                                       â”‚ â”‚
â”‚  â”‚      type: "payment_alert",                                    â”‚ â”‚
â”‚  â”‚      message: "Payment due in 1 week...",                      â”‚ â”‚
â”‚  â”‚      bookingId: 123,                                           â”‚ â”‚
â”‚  â”‚      read: false,                                              â”‚ â”‚
â”‚  â”‚      timestamp: "2024-12-18T09:00:00Z"                         â”‚ â”‚
â”‚  â”‚    },                                                           â”‚ â”‚
â”‚  â”‚    ...                                                          â”‚ â”‚
â”‚  â”‚  ]                                                              â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  Key: "notification_schedules"                                  â”‚ â”‚
â”‚  â”‚  Value: [                                                       â”‚ â”‚
â”‚  â”‚    {                                                            â”‚ â”‚
â”‚  â”‚      bookingId: 123,                                           â”‚ â”‚
â”‚  â”‚      type: "payment_alert_7_days",                             â”‚ â”‚
â”‚  â”‚      triggered: true,                                          â”‚ â”‚
â”‚  â”‚      triggeredAt: "2024-12-18T09:00:00Z"                       â”‚ â”‚
â”‚  â”‚    },                                                           â”‚ â”‚
â”‚  â”‚    ...                                                          â”‚ â”‚
â”‚  â”‚  ]                                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CROSS-TAB SYNCHRONIZATION                         â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         Storage Events         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Tab 1     â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚    Tab 2    â”‚    â”‚
â”‚  â”‚             â”‚                                  â”‚             â”‚    â”‚
â”‚  â”‚  Booking    â”‚    Custom Events:                â”‚  Booking    â”‚    â”‚
â”‚  â”‚  Created    â”‚    â€¢ bookings-updated            â”‚  Appears    â”‚    â”‚
â”‚  â”‚     â†“       â”‚    â€¢ notifications-updated       â”‚  Instantly  â”‚    â”‚
â”‚  â”‚  Dispatch   â”‚                                  â”‚     â†“       â”‚    â”‚
â”‚  â”‚   Event     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  Listen &   â”‚    â”‚
â”‚  â”‚             â”‚                                  â”‚  Refresh    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATABASE LAYER                             â”‚
â”‚                         (Initial Sync Only)                          â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Prisma Database                              â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  GET /api/bookings/all  â†â”€â”€â”€â”€ BookingSync.tsx (on app load)   â”‚ â”‚
â”‚  â”‚         â†“                                                       â”‚ â”‚
â”‚  â”‚  Returns all bookings with billing data                        â”‚ â”‚
â”‚  â”‚         â†“                                                       â”‚ â”‚
â”‚  â”‚  Synced to LocalStorage once                                   â”‚ â”‚
â”‚  â”‚                                                                  â”‚ â”‚
â”‚  â”‚  POST /api/bookings/create  â†â”€â”€ Booking Form                   â”‚ â”‚
â”‚  â”‚         â†“                                                       â”‚ â”‚
â”‚  â”‚  Database INSERT                                                â”‚ â”‚
â”‚  â”‚         â†“                                                       â”‚ â”‚
â”‚  â”‚  integrateNewBooking() called                                  â”‚ â”‚
â”‚  â”‚         â†“                                                       â”‚ â”‚
â”‚  â”‚  Added to LocalStorage                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagrams

### 1. Initial App Load Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Logs  â”‚
â”‚    In      â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BookingSync.tsx    â”‚
â”‚ - useQuery hook    â”‚
â”‚ - Fetch API        â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/bookings/all  â”‚
â”‚ - Returns all bookings â”‚
â”‚ - Includes billing     â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ syncAllBookings()         â”‚
â”‚ - Maps DB â†’ LocalStorage  â”‚
â”‚ - Stores in browser       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BookingSystemProvider      â”‚
â”‚ - Starts status timer      â”‚
â”‚ - Starts notification timerâ”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ System Ready! âœ…   â”‚
â”‚ - Bookings loaded  â”‚
â”‚ - Timers running   â”‚
â”‚ - UI rendered      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. New Booking Creation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Fills Form  â”‚
â”‚ & Clicks Submit  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validate Form Data     â”‚
â”‚ - Check required fieldsâ”‚
â”‚ - Show red borders     â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ createBookingMutation      â”‚
â”‚ - Save to database         â”‚
â”‚ - Returns booking ID       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ createBillingMutation      â”‚
â”‚ - Save billing record      â”‚
â”‚ - Calculate prices         â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Upload Documents (if any)  â”‚
â”‚ - Client IDs, contracts    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”„ integrateNewBooking()    â”‚
â”‚ - Add to LocalStorage       â”‚
â”‚ - Calculate initial status  â”‚
â”‚ - Trigger notification      â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”” sendNewBookingNotif()   â”‚
â”‚ - Create notification      â”‚
â”‚ - Show toast popup         â”‚
â”‚ - Update bell badge        â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show Success Dialog âœ… â”‚
â”‚ - Booking created      â”‚
â”‚ - Notification sent    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3. Status Update Cycle (Every 5 seconds)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Timer Triggers (5000ms)  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ updateAllBookingStatuses() â”‚
â”‚ - Read all from LocalStorageâ”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Loop Each Booking:         â”‚
â”‚                            â”‚
â”‚ For booking in bookings:   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ calculateBooking     â”‚ â”‚
â”‚   â”‚ Status(booking)      â”‚ â”‚
â”‚   â”‚ - Check current time â”‚ â”‚
â”‚   â”‚ - Compare dates      â”‚ â”‚
â”‚   â”‚ - Check payment      â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                  â”‚
â”‚         â–¼                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Status Changed?      â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚ Yes              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ updateLocalBooking()    â”‚
â”‚ - Save new status       â”‚
â”‚ - Log change to history â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dispatch Event          â”‚
â”‚ - "bookings-updated"    â”‚
â”‚ - Cross-tab sync        â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UI Re-renders           â”‚
â”‚ - Badges update colors  â”‚
â”‚ - Dashboard updates     â”‚
â”‚ - Stats recalculated    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4. Notification Check Cycle (Every 10 seconds)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Timer Triggers (10000ms)   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ checkPaymentAlerts()       â”‚
â”‚                            â”‚
â”‚ For each booking:          â”‚
â”‚   days = getDaysUntilEvent()â”‚
â”‚                            â”‚
â”‚   If days == 7:            â”‚
â”‚     â†’ Create notification  â”‚
â”‚   If days == 3:            â”‚
â”‚     â†’ Create notification  â”‚
â”‚   If days == 1:            â”‚
â”‚     â†’ Create notification  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ checkUnpaidReminders()     â”‚
â”‚                            â”‚
â”‚ For each unpaid booking:   â”‚
â”‚   If event ended:          â”‚
â”‚     daysSince = calculate  â”‚
â”‚     If daysSince % 3 == 0: â”‚
â”‚       â†’ Create reminder    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ hasNotificationBeenTriggered?â”‚
â”‚ - Check schedules table    â”‚
â”‚ - Prevent duplicates       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚ New notification needed
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ addLocalNotification()     â”‚
â”‚ - Save to LocalStorage     â”‚
â”‚ - Generate unique ID       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ recordNotificationSchedule()â”‚
â”‚ - Mark as triggered        â”‚
â”‚ - Timestamp recorded       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show Toast Popup ğŸ””        â”‚
â”‚ - Type-specific message    â”‚
â”‚ - Color-coded              â”‚
â”‚ - Auto-dismiss in 5s       â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update Bell Badge          â”‚
â”‚ - Increment unread count   â”‚
â”‚ - Show red dot             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Status Transition Diagram

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Booking Created    â”‚
                    â”‚      Status: 1       â”‚
                    â”‚      (PENDING)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                     Down payment received
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Status: 2         â”‚
                    â”‚    (CONFIRMED)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                     Event start time reached
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Status: 3         â”‚
                    â”‚   (IN PROGRESS)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                         Event ends
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                      â”‚
            Full payment?            Balance > 0?
                    â”‚                      â”‚
                    â–¼                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Status: 4      â”‚   â”‚   Status: 5      â”‚
         â”‚   (COMPLETED)    â”‚   â”‚    (UNPAID)      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                      â”‚
                  â”‚                Payment received
                  â”‚                      â”‚
                  â”‚                      â–¼
                  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚            â”‚   Status: 4      â”‚
                  â”‚            â”‚   (COMPLETED)    â”‚
                  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                      30+ days later
                             â”‚
                             â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   Status: 7      â”‚
                  â”‚   (ARCHIVED)     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Manual action at any time:
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Status: 6      â”‚
         â”‚   (CANCELLED)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”” Notification Timeline

```
Event Date: December 25, 2024 at 10:00 AM

Timeline:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â†’

Dec 18              Dec 22           Dec 24           Dec 25
09:00 AM            09:00 AM         09:00 AM         10:00 AM
   â”‚                   â”‚                â”‚                â”‚
   â–¼                   â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ””   â”‚          â”‚ ğŸ””   â”‚         â”‚ ğŸ””   â”‚        â”‚ ğŸ‰   â”‚
â”‚ 7    â”‚          â”‚ 3    â”‚         â”‚ 1    â”‚        â”‚Event â”‚
â”‚ days â”‚          â”‚ days â”‚         â”‚ day  â”‚        â”‚Start â”‚
â”‚beforeâ”‚          â”‚beforeâ”‚         â”‚beforeâ”‚        â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”˜
"Payment          "Payment         "Payment        Status:
reminder:         reminder:        reminder:       IN PROGRESS
Event in          Event in         Event in
1 week"           3 days"          1 day"

If unpaid after event ends:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â†’

Dec 25              Dec 28           Dec 31           Jan 3
03:00 PM            (3 days)         (6 days)         (9 days)
Event ends              â”‚                â”‚                â”‚
   â”‚                    â–¼                â–¼                â–¼
   â–¼                â”Œâ”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”
Status: UNPAID      â”‚ ğŸ””   â”‚         â”‚ ğŸ””   â”‚        â”‚ ğŸ””   â”‚
                    â”‚Unpaidâ”‚         â”‚Unpaidâ”‚        â”‚Unpaidâ”‚
                    â”‚Remindâ”‚         â”‚Remindâ”‚        â”‚Remindâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”˜
                    "Balance         "Balance        "Balance
                    reminder"        reminder"       reminder"

                    Repeats every 3 days until paid
```

---

## ğŸ¨ Component Hierarchy

```
app/
â””â”€â”€ layout.tsx
    â””â”€â”€ <BookingSystemProvider>
        â”‚
        â”œâ”€â”€ useBookingStatusUpdater() â”€â”€â†’ Updates all bookings every 5s
        â”‚   â””â”€â”€ Returns: { bookings, stats, changes[] }
        â”‚
        â”œâ”€â”€ useNotifications() â”€â”€â†’ Checks notifications every 10s
        â”‚   â””â”€â”€ Returns: { notifications, unreadCount, functions }
        â”‚
        â”œâ”€â”€ <Toaster /> â”€â”€â†’ Shows toast popups
        â”‚
        â””â”€â”€ <BookingSync /> â”€â”€â†’ Initial database sync
            â”‚
            â””â”€â”€ children (your app)
                â”‚
                â”œâ”€â”€ app-sidebar.tsx
                â”‚   â””â”€â”€ <NotificationBell />
                â”‚       â”œâ”€â”€ Uses: useNotifications()
                â”‚       â”œâ”€â”€ Dropdown menu
                â”‚       â””â”€â”€ Badge with count
                â”‚
                â”œâ”€â”€ dashboard/page.tsx
                â”‚   â””â”€â”€ <BookingStatusDashboard />
                â”‚       â”œâ”€â”€ Uses: useBookingStatusUpdater()
                â”‚       â”œâ”€â”€ Statistics cards
                â”‚       â””â”€â”€ Recent changes
                â”‚
                â””â”€â”€ bookings/create-booking/page.tsx
                    â””â”€â”€ When booking created:
                        â””â”€â”€ integrateNewBooking()
                            â””â”€â”€ Triggers notification
```

---

## ğŸ’¾ LocalStorage Schema

```typescript
// Key: "bookings"
type LocalBooking = {
  id: number;
  eventName: string;
  startAt: string;        // ISO 8601
  endAt: string;          // ISO 8601
  status: 1 | 2 | 3 | 4 | 5 | 6 | 7;
  balance: number;
  originalPrice: number;
  pavilionId: number | null;
  clientId: number;
  createdAt: string;      // ISO 8601
};

// Key: "notifications"
type LocalNotification = {
  id: string;
  type: 'new_booking' | 'payment_alert' | 'unpaid_reminder';
  message: string;
  bookingId: number;
  read: boolean;
  timestamp: string;      // ISO 8601
};

// Key: "notification_schedules"
type NotificationSchedule = {
  bookingId: number;
  type: string;
  triggered: boolean;
  triggeredAt?: string;   // ISO 8601
};
```

---

This architecture provides a **complete offline-first booking management system** with real-time updates, smart notifications, and beautiful UI components! ğŸ‰
